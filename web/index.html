<html>
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="author" content="colorlib.com" />
    <link
      href="https://fonts.googleapis.com/css?family=Poppins"
      rel="stylesheet"
    />
    <link href="css/main.css" rel="stylesheet" />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.3.0/css/all.min.css"
      integrity="sha512-SzlrxWUlpfuzQ+pcUCosxcglQRNAq/DZjVsC0lE40xsADsfeQoEypE+enwcOiGjk/bSuGGKHEyjSoQ1zVisanQ=="
      crossorigin="anonymous"
      referrerpolicy="no-referrer"
    />
  </head>
  <body>
    <div class="s003">
      <form>
        <div class="inner-form">
          <div class="input-field first-wrap">
            <div class="input-select">
              <select data-trigger="" name="choices-single-defaul">
                <option>Model 1</option>
                <option>Model 2</option>
                <option>Model 3</option>
              </select>
            </div>
          </div>
          <div class="input-field second-wrap">
            <input
              id="sentence"
              type="text"
              placeholder="Enter Sentence and analyze sentiment"
            />
          </div>
          <div class="input-field third-wrap">
            <button class="btn-search" onclick="analyze()" type="button">
              <i class="fa-solid fa-chart-simple"></i>
            </button>
          </div>
        </div>
        <br />

        <p id="result"><br /></p>
        <p id="result2"><br /></p>
      </form>
    </div>
    <script src="js/extention/choices.js"></script>
    <script>
      const choices = new Choices("[data-trigger]", {
        searchEnabled: false,
        itemSelectText: "",
      });

      async function analyze() {
        var text = document.getElementById("sentence").value;
        await fetch(`${backendUrl}`, {
          method: "POST",
          headers: {
            "Content-Type": "application/json",
          },
          body: JSON.stringify({
            text: text,
          }),
        })
          .then((response) => response.json())
          .then((data) => {
            if (data.code == 404) {
              alert("Time Out");
            } else {
              var sentiment = "";
              if (data.results == "LABEL_0") {
                sentiment = "normal";
              } else {
                sentiment = "suicidal";
              }

              var a = document.getElementById("result");
              a.innerText = "RESULTS: " + sentiment;
              var b = document.getElementById("result2");
              b.innerText =
                "Normal probability: " +
                data.prob1 +
                " and suicidal probability: " +
                data.prob2;
            }
          })
          .catch((error) => {
            // Errors when calling the service; such as network error,
            // service offline, etc
            console.log(error);
          });
      }
      var backendUrl = "http://127.0.0.1:3000/predict";
    </script>
  </body>
</html>
